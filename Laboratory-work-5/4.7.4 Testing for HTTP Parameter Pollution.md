Тестування на забруднення параметрів HTTP

ID
WSTG-INPV-04

Резюме
Забруднення параметрів HTTP перевіряє відповідь програм на отримання кількох параметрів HTTP з однаковою назвою; наприклад, якщо параметр ім'я користувача включено в параметри GET або POST двічі.
Надання кількох параметрів HTTP з однаковою назвою може призвести до того, що програма інтерпретуватиме значення непередбачуваним чином. Використовуючи ці ефекти, зловмисник може обійти перевірку введення, викликати помилки програми або змінити значення внутрішніх змінних. Оскільки забруднення параметрів HTTP (скорочено HPP) впливає на будівельний блок усіх веб-технологій, існують атаки на стороні сервера та клієнта.

Поточні стандарти HTTP не містять вказівок щодо інтерпретації кількох вхідних параметрів з однаковою назвою. Наприклад, RFC 3986 просто визначає термін «Рядок запиту» як серію пар «поле-значення», а RFC 2396 визначає класи зворотних і незарезервованих символів рядка запиту. За відсутності стандарту компоненти веб-додатків обробляють цей крайовий випадок різними способами (докладніше див. у таблиці нижче).
Саме по собі це не обов’язково свідчить про вразливість. Однак, якщо розробник не знає про проблему, наявність дубльованих параметрів може спричинити аномальну поведінку програми, якою потенційно може скористатися зловмисник. Як це часто трапляється в системі безпеки, несподівана поведінка є звичайним джерелом слабких місць, які в цьому випадку можуть призвести до атак із забрудненням параметрів HTTP.Щоб краще представити цей клас уразливостей і результати атак на HPP, цікаво проаналізувати деякі приклади з реального життя, які були виявлені в минулому.

Перевірка вхідних даних і обхід фільтрів
У 2009 році, відразу після публікації першого дослідження забруднення параметрів HTTP, ця техніка привернула увагу спільноти безпеки як можливий спосіб обійти брандмауери веб-додатків.

Один із цих недоліків, що впливає на основні правила впровадження SQL ModSecurity, є чудовим прикладом невідповідності імпедансу між програмами та фільтрами. Фільтр ModSecurity правильно застосував би список заборони для такого рядка: виберіть 1,2,3 із таблиці, таким чином блокуючи цей приклад URL-адреси від обробки веб-сервером: /index.aspx?page=select 1,2,3 з стіл. Однак, використовуючи конкатенацію кількох параметрів HTTP, зловмисник може змусити сервер додатків об’єднати рядок після того, як фільтр ModSecurity вже прийняв вхідні дані. Наприклад, URL-адреса /index.aspx?page=select 1&page=2,3 із таблиці не запускатиме фільтр ModSecurity, але прикладний рівень об’єднає вхідні дані назад у повний шкідливий рядок.

Виявилося, що ще одна вразливість HPP впливає на Apple Cups, добре відому систему друку, яка використовується багатьма системами UNIX. Використовуючи HPP, зловмисник може легко викликати вразливість міжсайтового сценарію за такою URL-адресою: http://127.0.0.1:631/admin/?kerberos=onmouseover=alert(1)&kerberos. Контрольну точку перевірки програми можна обійти, додавши додатковий аргумент kerberos із дійсним рядком (наприклад,порожній рядок). Оскільки контрольна точка перевірки розглядатиме лише другий випадок, перший параметр kerberos не було належним чином оброблено перед використанням для створення динамічного вмісту HTML. Успішне використання призведе до виконання коду JavaScript у контексті веб-сайту хостингу.

Обхід автентифікації
У Blogger, популярній платформі для блогів, виявлено ще більш критичну вразливість HPP. Помилка дозволила зловмисникам отримати право власності на блог жертви за допомогою наступного запиту HTTP (https://www.blogger.com/add-authors.do):
  
  POST /add-authors.do HTTP/1.1
  [...]
  
  security_token=attackertoken&blogID=attackerblogidvalue&blogID=victimblogidvalue&authorsList=goldshlager19test%40gmail.com(attacker email)&ok=Invite

